<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- The HTML 4.01 Transitional DOCTYPE declaration-->
<!-- above set at the top of the file will set     -->
<!-- the browser's rendering engine into           -->
<!-- "Quirks Mode". Replacing this declaration     -->
<!-- with a "Standards Mode" doctype is supported, -->
<!-- but may lead to some differences in layout.   -->

<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="gwt:module" content="purcforms"/>
    <title>PurcForms FormDesigner</title>
     <script type="text/javascript" language="javascript" src="FormDesigner.nocache.js"></script>
         <script type="text/javascript">
                function getQueryVariable(variable) {
                        var query = window.location.search.substring(1);
                        var vars = query.split("&");
                        for (var i=0;i<vars.length;i++) {
                                var pair = vars[i].split("=");
                                if (pair[0] == variable) {
                                return pair[1];
                                }
                        }

                        return '';
                        //alert('Query Variable ' + variable + ' not found');
                }


                function genStr(){
                        var text = "";
                        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

                        for( var i=0; i < 10; i++ )
                                text += possible.charAt(Math.floor(Math.random() * possible.length));

                        document.getElementById('formDefRefreshUrlSuffix').innerHTML= "getXform?random=" + text + "&amp;";
                        document.getElementById('formDefDownloadUrlSuffix').innerHTML= "getXform?random=" + text + "&amp;";
                        document.getElementById('formDefUploadUrlSuffix').innerHTML="saveXform?random="+text+"&amp;";
                };
         </script>
   </head>
  <body>
    <iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1' style="position:absolute;width:0;height:0;border:0"></iframe>
    <div id="purcformsdesigner"></div>
    <div id="title" style="visibility:hidden;">PurcForms FormDesigner</div>
    <div id="rubberBand"></div>

   <div id="formId" style="visibility:hidden;">1</div>
   <div id="readOnly" style="visibility:hidden;">false</div>
    
    <script type="text/javascript">
                var formId = getQueryVariable('surveyId');
                if(formId.length > 0)
                        document.getElementById('formId').innerHTML = formId;
                else
                        window.location = 'error.html';

                var status = getQueryVariable('status');

                if(status != null){
                	status = status.toLowerCase();
                	if(status == 'completed' || status == 'published')
                    	document.getElementById('readOnly').innerHTML = "true";
                }
    </script>


    <div id="dateTimeSubmitFormat" style="visibility:hidden;">yyyy-MM-dd hh:mm a</div>
    <div id="dateTimeDisplayFormat" style="visibility:hidden;">dd/MM/yyyy hh:mm a</div>
    <div id="timeSubmitFormat" style="visibility:hidden;">hh:mm a</div>
    <div id="timeDisplayFormat" style="visibility:hidden;">hh:mm a</div>
    <div id="dateSubmitFormat" style="visibility:hidden;">yyyy-MM-dd</div>
    <div id="dateDisplayFormat" style="visibility:hidden;">dd/MM/yyyy</div>
    <div id="showLanguageTab" style="visibility:hidden;">0</div>
    <div id="showXformsSourceTab" style="visibility:hidden;">1</div>
    <div id="showLayoutXmlTab" style="visibility:hidden;">0</div>
    <div id="showModelXmlTab" style="visibility:hidden;">0</div>
    <div id="showJavaScriptTab" style="visibility:hidden;">0</div>
    <div id="allowBindEdit" style="visibility:hidden;">1</div>
    <div id="combineFormOnSave" style="visibility:hidden;">0</div>
    <div id="saveFormat" style="visibility:hidden;">javarosa</div>
    <div id="rebuildBindings" style="visibility:hidden;">1</div>

    <div id="showPreviewTab" style="visibility:hidden;">0</div>
    <div id="showDesignSurfaceTab" style="visibility:hidden;">0</div>
    <div id="showDynamicListsTab" style="visibility:hidden;">0</div>
    <div id="defaultFontSize" style="visibility:hidden;">16</div>
    <div id="defaultFontFamily" style="visibility:hidden;">Verdana, 'Lucida Grande', 'Trebuchet MS', Arial, Sans-Serif</div>

    <!-- <div id="entityIdName" style="visibility:hidden;">patientId</div> -->
    <div id="formIdName" style="visibility:hidden;">surveyId</div>

    <div id="formDefDownloadUrlSuffix" style="visibility:hidden;"></div>
    <div id="formDefUploadUrlSuffix" style="visibility:hidden;"></div>
    <div id="formDefRefreshUrlSuffix" style="visibility:hidden;"></div>
        <script type="text/javascript">                
        	genStr();
        </script>

    <!-- <div id="entityFormDefDownloadUrlSuffix" style="visibility:hidden;">moduleServlet/xforms/xformDownload?target=xformentry&contentType=xml&</di
v> -->
    <!-- <div id="formDataUploadUrlSuffix" style="visibility:hidden;">module/xforms/xformDataUpload.form</div> -->
    <!-- <div id="afterSubmitUrlSuffix" style="visibility:hidden;">patientDashboard.form?</div> -->

    <!-- <div id="loading"><img src="loading.gif">Loading app</div> -->
    <script language = "javascript">
	    if(getQueryVariable('language') == 'es') {
	    	document.write('<div id="localeList" style="visibility:hidden;">es:Spanish</div>');
	    	document.write('<script type="text/javascript" src="es.js"><\/script>');
	    } else {
	    	document.write('<div id="localeList" style="visibility:hidden;">en:English</div>');
	    	document.write('<script type="text/javascript" src="en.js"/><\/script>');
	    }
    </script>

    <div id="labelEdit" style="visibility:hidden;width:auto;height:auto;position:absolute;"></div>

    <script language="javascript">
        function isUserAuthenticated(){
                authenticationCallback(true);
                return true; //Not expected to be used in the design mode.
        }

        function authenticateUser(username, password){
                return true; //Not expected to be used in the design mode.
        }

        function searchExternal(key,value,parentElement,textElement,valueElement,filterField){

        }

        function initialize(){

        }

        function getQuestionBinding(id, pos){
                return "q" + pos;
        }

        function getOptionBinding(id, pos){
                return "" + pos;
        }
    </script>

  </body>
</html> 